LOG:  database system was shut down at 2017-10-16 02:32:35 +08
LOG:  MultiXact member wraparound protections are now enabled
LOG:  database system is ready to accept connections
LOG:  autovacuum launcher started
LOG:  statement: CREATE TABLE temp_publication (
	    pub_id INT PRIMARY KEY,
	    pub_key TEXT UNIQUE,
	    title TEXT,
	    pub_date DATE
	);
LOG:  duration: 4.520 ms
LOG:  statement: CREATE TABLE temp_book (
	    pub_id INT PRIMARY KEY,
	    pub_key TEXT UNIQUE
	) INHERITS (temp_publication);
LOG:  duration: 2.591 ms
LOG:  statement: CREATE TABLE temp_incollection (
	    pub_id INT PRIMARY KEY,
	    pub_key TEXT UNIQUE
	) INHERITS (temp_publication);
LOG:  duration: 2.413 ms
LOG:  statement: CREATE TABLE temp_masters_thesis (
	    pub_id INT PRIMARY KEY,
	    pub_key TEXT UNIQUE
	) INHERITS (temp_publication);
LOG:  duration: 2.753 ms
LOG:  statement: CREATE TABLE temp_phd_thesis (
	    pub_id INT PRIMARY KEY,
	    pub_key TEXT UNIQUE
	) INHERITS (temp_publication);
LOG:  duration: 2.331 ms
LOG:  statement: CREATE TABLE temp_proceedings (
	    pub_id INT PRIMARY KEY,
	    pub_key TEXT UNIQUE,
	    booktitle TEXT
	) INHERITS (temp_publication);
LOG:  duration: 2.679 ms
LOG:  statement: CREATE TABLE temp_inproceedings (
	    pub_id INT PRIMARY KEY,
	    pub_key TEXT UNIQUE,
	    booktitle TEXT
	) INHERITS (temp_publication);
LOG:  duration: 2.387 ms
LOG:  statement: CREATE TABLE temp_article (
	    pub_id INT PRIMARY KEY,
	    pub_key TEXT UNIQUE,
	    journal TEXT
	) INHERITS (temp_publication);
LOG:  duration: 2.118 ms
LOG:  statement: INSERT INTO temp_inproceedings
	SELECT temp.pub_id, temp.pub_key, temp.title, temp.pub_date, temp.booktitle
	FROM (
	    SELECT *, row_number() OVER(ORDER BY pub_id) as rnum
	    FROM inproceedings
	) as temp
	WHERE mod(temp.rnum,2) = 0;
LOG:  duration: 4195.344 ms
LOG:  statement: INSERT INTO temp_proceedings
	SELECT temp.pub_id, temp.pub_key, temp.title, temp.pub_date, temp.booktitle
	FROM (
	    SELECT *, row_number() OVER(ORDER BY pub_id) as rnum
	    FROM proceedings
	) as temp
	WHERE mod(temp.rnum,2) = 0;
LOG:  duration: 52.620 ms
LOG:  statement: INSERT INTO temp_article
	SELECT temp.pub_id, temp.pub_key, temp.title, temp.pub_date, temp.journal
	FROM (
	    SELECT *, row_number() OVER(ORDER BY pub_id) as rnum
	    FROM article
	) as temp
	WHERE mod(temp.rnum,2) = 0;
LOG:  duration: 3568.218 ms
LOG:  statement: INSERT INTO temp_book
	SELECT temp.pub_id, temp.pub_key, temp.title, temp.pub_date
	FROM (
	    SELECT *, row_number() OVER(ORDER BY pub_id) as rnum
	    FROM book
	) as temp
	WHERE mod(temp.rnum,2) = 0;
LOG:  duration: 16.823 ms
LOG:  statement: INSERT INTO temp_incollection
	SELECT temp.pub_id, temp.pub_key, temp.title, temp.pub_date
	FROM (
	    SELECT *, row_number() OVER(ORDER BY pub_id) as rnum
	    FROM incollection
	) as temp
	WHERE mod(temp.rnum,2) = 0;
LOG:  duration: 59.494 ms
LOG:  statement: INSERT INTO temp_phd_thesis
	SELECT temp.pub_id, temp.pub_key, temp.title, temp.pub_date
	FROM (
	    SELECT *, row_number() OVER(ORDER BY pub_id) as rnum
	    FROM phd_thesis
	) as temp
	WHERE mod(temp.rnum,2) = 0;
LOG:  duration: 96.957 ms
LOG:  statement: INSERT INTO temp_masters_thesis
	SELECT temp.pub_id, temp.pub_key, temp.title, temp.pub_date
	FROM (
	    SELECT *, row_number() OVER(ORDER BY pub_id) as rnum
	    FROM masters_thesis
	) as temp
	WHERE mod(temp.rnum,2) = 0;
LOG:  duration: 0.849 ms
LOG:  statement: DROP TABLE IF EXISTS publication CASCADE;
LOG:  duration: 56.206 ms
LOG:  statement: DROP TABLE IF EXISTS book CASCADE;
LOG:  duration: 0.169 ms
LOG:  statement: DROP TABLE IF EXISTS incollection CASCADE;
LOG:  duration: 0.048 ms
LOG:  statement: DROP TABLE IF EXISTS masters_thesis CASCADE;
LOG:  duration: 0.069 ms
LOG:  statement: DROP TABLE IF EXISTS phd_thesis CASCADE;
LOG:  duration: 0.048 ms
LOG:  statement: DROP TABLE IF EXISTS article CASCADE;
LOG:  duration: 0.074 ms
LOG:  statement: DROP TABLE IF EXISTS proceedings CASCADE;
LOG:  duration: 0.037 ms
LOG:  statement: DROP TABLE IF EXISTS inproceedings CASCADE;
LOG:  duration: 0.033 ms
LOG:  statement: ALTER TABLE temp_publication RENAME TO publication;
LOG:  duration: 0.359 ms
LOG:  statement: ALTER TABLE temp_book RENAME TO book;
LOG:  duration: 0.276 ms
LOG:  statement: ALTER TABLE temp_incollection RENAME TO incollection;
LOG:  duration: 0.421 ms
LOG:  statement: ALTER TABLE temp_phd_thesis RENAME TO phd_thesis;
LOG:  duration: 0.757 ms
LOG:  statement: ALTER TABLE temp_masters_thesis RENAME TO masters_thesis;
LOG:  duration: 1.277 ms
LOG:  statement: ALTER TABLE temp_proceedings RENAME TO proceedings;
LOG:  duration: 0.290 ms
LOG:  statement: ALTER TABLE temp_inproceedings RENAME TO inproceedings;
LOG:  duration: 1.123 ms
LOG:  statement: ALTER TABLE temp_article RENAME TO article;
LOG:  duration: 0.255 ms
LOG:  statement: VACUUM;
ERROR:  canceling autovacuum task
CONTEXT:  automatic analyze of table "dblp.public.inproceedings"
ERROR:  canceling autovacuum task
CONTEXT:  automatic analyze of table "dblp.public.article"
LOG:  duration: 2688.937 ms
LOG:  statement: ANALYZE;
LOG:  duration: 805.817 ms
LOG:  statement: DROP INDEX IF EXISTS book_date;
LOG:  duration: 0.477 ms
LOG:  statement: DROP INDEX IF EXISTS article_date;
LOG:  duration: 0.079 ms
LOG:  statement: DROP INDEX IF EXISTS incollection_date;
LOG:  duration: 0.053 ms
LOG:  statement: DROP INDEX IF EXISTS masters_thesis_date;
LOG:  duration: 0.046 ms
LOG:  statement: DROP INDEX IF EXISTS phd_thesis_date;
LOG:  duration: 0.044 ms
LOG:  statement: DROP INDEX IF EXISTS proceedings_date;
LOG:  duration: 0.064 ms
LOG:  statement: DROP INDEX IF EXISTS inproceedings_date;
LOG:  duration: 0.064 ms
LOG:  statement: DROP INDEX IF EXISTS proceedings_conference;
LOG:  duration: 0.044 ms
LOG:  statement: DROP INDEX IF EXISTS inproceedings_conference;
LOG:  duration: 0.058 ms
LOG:  statement: DROP INDEX IF EXISTS article_journal;
LOG:  duration: 0.074 ms
LOG:  statement: DROP VIEW IF EXISTS publication_author CASCADE;
LOG:  duration: 0.047 ms
LOG:  statement: CREATE VIEW publication_author AS 
	(
	   SELECT pb.pub_id, pb.title, a.author_name
	   FROM publication AS pb, authored AS aed, author AS a
	   WHERE pb.pub_id = aed.pub_id AND aed.author_ID = a.author_ID
	   ORDER BY pb.pub_id
	);
LOG:  duration: 2.294 ms
LOG:  statement: SELECT type, COUNT(*)
	FROM (
	      (
	       SELECT 'book' as type, extract(year from pub_date) as year
	       FROM book
	       )
	      UNION ALL
	      (
	       SELECT 'incollection' as type, extract(year from pub_date) as year
	       FROM incollection
	       )
	      UNION ALL
	      (
	       SELECT 'masters_thesis' as type, extract(year from pub_date) as year
	       FROM masters_thesis
	       )
	      UNION ALL
	      (
	       SELECT 'phd_thesis' as type, extract(year from pub_date) as year
	       FROM phd_thesis
	       )
	      UNION ALL
	      (
	       SELECT 'proceedings' as type, extract(year from pub_date) as year
	       FROM proceedings
	       )
	      UNION ALL
	      (
	       SELECT 'inproceedings' as type, extract(year from pub_date) as year
	       FROM inproceedings
	       )
	      UNION ALL
	      (
	       SELECT 'article' as type, extract(year from pub_date) as year
	       FROM article
	       )
	      ) AS publ_list
	WHERE year BETWEEN 2000 AND 2017
	GROUP BY type
	ORDER BY type;
LOG:  duration: 879.937 ms
LOG:  statement: DROP VIEW IF EXISTS proceedings_inproceedings CASCADE;
LOG:  duration: 0.114 ms
LOG:  statement: CREATE VIEW proceedings_inproceedings AS (
	    SELECT *
	    FROM proceedings 
	    UNION 
	    SELECT *
	    FROM inproceedings
	);
LOG:  duration: 0.971 ms
LOG:  statement: SELECT *
	FROM (
	      SELECT booktitle, extract(year from pub_date) as year, COUNT(*) AS conferences_count
	      FROM (
	            SELECT *
	            FROM proceedings_inproceedings
	            WHERE extract(month from pub_date) = 7
	            ) AS julyConferences
	      GROUP BY booktitle, year
	      ) AS result_set
	WHERE conferences_count > 200;
LOG:  duration: 170.569 ms
LOG:  statement: DROP VIEW IF EXISTS publication_author CASCADE;
LOG:  duration: 1.004 ms
LOG:  statement: CREATE VIEW publication_author AS 
	(
	   SELECT pb.pub_id, pb.title, pb.pub_date, a.author_name
	   FROM publication AS pb, authored AS aed, author AS a
	   WHERE pb.pub_id = aed.pub_id AND aed.author_id = a.author_id
	   ORDER BY pb.pub_id
	);
LOG:  duration: 0.821 ms
LOG:  statement: SELECT author_name, pub_id, title
	FROM publication_author
	WHERE author_name = 'Liming Chen' AND extract(year from pub_date) = 2015;
LOG:  duration: 572.564 ms
LOG:  statement: SELECT author_name, pa.pub_id, pa.title
	FROM publication_author pa, proceedings_inproceedings i
	WHERE pa.pub_id = i.pub_id AND author_name = 'Liming Chen' AND extract(year from pa.pub_date) = 2015 AND i.booktitle = 'ICB';
LOG:  duration: 566.205 ms
LOG:  statement: SELECT *
	FROM (
	      SELECT author_name, booktitle, EXTRACT(YEAR FROM pa.pub_date) AS year, COUNT(*) AS paper_count
	      FROM proceedings_inproceedings AS i
	      JOIN publication_author AS pa
	      ON i.pub_id = pa.pub_id
	      GROUP BY author_name, booktitle, year
	   ) AS result_set
	WHERE author_name = 'Liming Chen' AND year = 2009 AND paper_count > 1 AND booktitle = 'ACIVS';
LOG:  duration: 538.133 ms
LOG:  statement: DROP VIEW IF EXISTS conf_journal_papers CASCADE;
LOG:  duration: 0.099 ms
LOG:  statement: DROP VIEW IF EXISTS papers_with_authors CASCADE;
LOG:  duration: 0.055 ms
LOG:  statement: CREATE VIEW conf_journal_papers AS (
	   SELECT *
	   FROM (
	      SELECT pub_id, title, pub_date, booktitle AS confjournal
	      FROM proceedings_inproceedings
	   ) AS result_set
	   UNION (
	      SELECT pub_id, title, pub_date, journal AS confjournal
	      FROM article
	   )
	);
LOG:  duration: 2.054 ms
LOG:  statement: CREATE VIEW papers_with_authors AS (
	   SELECT cjp.*, pa.author_name
	   FROM conf_journal_papers cjp, publication_author pa
	   WHERE cjp.pub_id = pa.pub_id
	);
LOG:  duration: 0.831 ms
LOG:  statement: (
	   SELECT DISTINCT author_name
	   FROM papers_with_authors
	   WHERE confjournal SIMILAR TO '%PVLDB%'
	   GROUP BY author_name, confjournal
	   HAVING COUNT(DISTINCT pub_id) > 9
	) INTERSECT (
	   SELECT DISTINCT author_name
	   FROM papers_with_authors
	   WHERE confjournal SIMILAR TO '%SIGMOD%'
	   GROUP BY author_name, confjournal
	   HAVING COUNT(DISTINCT pub_id) > 9
	);
LOG:  duration: 17828.970 ms
LOG:  statement: SELECT DISTINCT pwa1.author_name 
	FROM papers_with_authors pwa1
	WHERE pwa1.author_name IN (
	   SELECT DISTINCT author_name
	   FROM papers_with_authors
	   WHERE confjournal SIMILAR TO '%PVLDB%'
	   GROUP BY author_name, confjournal
	   HAVING COUNT(DISTINCT pub_id) > 14
	) AND pwa1.author_name NOT IN (
	   SELECT DISTINCT author_name
	   FROM papers_with_authors
	   WHERE confjournal SIMILAR TO '%KDD%'
	);
LOG:  duration: 8703.375 ms
LOG:  statement: SELECT *
	INTO yearly_count
	FROM (
	      SELECT extract(year from pub_date) as year, COUNT(*) as paper_count
	      FROM proceedings_inproceedings
	      GROUP BY year
	      ) AS result_set;
LOG:  duration: 671.119 ms
LOG:  statement: SELECT *
	FROM (
	      (
	       SELECT '1970-1979' AS year_range, SUM(paper_count) as decade_paper_count
	       FROM yearly_count
	       WHERE year BETWEEN 1970 AND 1979
	       GROUP BY year_range
	       )
	      UNION
	      (
	       SELECT '1980-1989' AS year_range, SUM(paper_count) as decade_paper_count
	       FROM yearly_count
	       WHERE year BETWEEN 1980 AND 1989
	       GROUP BY year_range
	       )
	      UNION
	      (
	       SELECT '1990-1999' AS year_range, SUM(paper_count) as decade_paper_count
	       FROM yearly_count
	       WHERE year BETWEEN 1990 AND 1999
	       GROUP BY year_range
	       )
	      UNION
	      (
	       SELECT '2000-2009' AS year_range, SUM(paper_count) as decade_paper_count
	       FROM yearly_count
	       WHERE year BETWEEN 2000 AND 2009
	       GROUP BY year_range
	       )
	      UNION
	      (
	       SELECT '2010-2019' AS year_range, SUM(paper_count) as decade_paper_count
	       FROM yearly_count
	       WHERE year BETWEEN 2010 AND 2019
	       GROUP BY year_range
	       )
	) as result_set
	ORDER BY year_range;
LOG:  duration: 1.022 ms
LOG:  statement: DROP TABLE yearly_count;
LOG:  duration: 0.548 ms
LOG:  statement: DROP VIEW IF EXISTS data_conferences CASCADE;
LOG:  duration: 0.050 ms
LOG:  statement: DROP VIEW IF EXISTS collaborators CASCADE;
LOG:  duration: 0.075 ms
LOG:  statement: DROP VIEW IF EXISTS collaborators_count CASCADE;
LOG:  duration: 0.066 ms
LOG:  statement: CREATE VIEW data_conferences AS 
	(
	   SELECT *
	   FROM papers_with_authors
	   WHERE confjournal SIMILAR TO '%[dD]ata%'
	);
LOG:  duration: 0.688 ms
LOG:  statement: CREATE VIEW collaborators AS
	(
	   SELECT dc1.author_name, dc2.author_name as collaborator
	   FROM data_conferences dc1
	   JOIN data_conferences dc2 ON dc1.pub_id = dc2.pub_id AND NOT dc1.author_name = dc2.author_name
	);
LOG:  duration: 0.619 ms
LOG:  statement: CREATE VIEW collaborators_count AS
	(
	   SELECT author_name, COUNT(DISTINCT collaborator) as collab_count
	   FROM collaborators
	   GROUP BY author_name
	   ORDER BY collab_count DESC
	);
LOG:  duration: 0.724 ms
LOG:  statement: SELECT author_name, collab_count
	FROM collaborators_count
	WHERE collab_count = (SELECT MAX(collab_count) FROM collaborators_count)
	ORDER BY author_name;
LOG:  duration: 37620.082 ms
LOG:  statement: DROP VIEW IF EXISTS data_conferences_5year CASCADE;
LOG:  duration: 0.073 ms
LOG:  statement: CREATE VIEW data_conferences_5year AS (
	    SELECT *
	    FROM papers_with_authors
	    WHERE title SIMILAR TO '%[dD]ata%' AND extract(year from pub_date) BETWEEN 2013 AND 2017
	);
LOG:  duration: 1.031 ms
LOG:  statement: SELECT author_name, COUNT(DISTINCT pub_id) AS pub_count
	FROM data_conferences_5year
	GROUP BY author_name
	ORDER BY pub_count DESC
	LIMIT 10;
LOG:  duration: 9824.600 ms
LOG:  statement: DROP VIEW IF EXISTS valid_conferences CASCADE;
LOG:  duration: 0.093 ms
LOG:  statement: CREATE VIEW valid_conferences AS (
	    SELECT booktitle, extract(year from pub_date) as year, COUNT(*) AS pub_count
	    FROM inproceedings
	    WHERE booktitle in (
	        SELECT DISTINCT booktitle 
	        FROM inproceedings
	        WHERE extract(month from pub_date) = 6
	    )
	    GROUP BY booktitle, year
	);
LOG:  duration: 0.862 ms
LOG:  statement: SELECT DISTINCT booktitle, year, pub_count
	FROM valid_conferences
	WHERE pub_count > 100
	ORDER BY pub_count;
LOG:  duration: 839.859 ms
LOG:  statement: SELECT *
	INTO h_family
	FROM publication_author pa
	WHERE pa.author_name SIMILAR TO '% H(\.|[a-z]+)';
LOG:  duration: 5619.535 ms
LOG:  statement: SELECT author_name, extract(year from pub_date) as year
	INTO author_year_1988_2017
	FROM h_family
	GROUP BY author_name, year
	HAVING
	    extract(year from pub_date) <= 2017 AND
	    extract(year from pub_date) >= 1988;
LOG:  duration: 306.074 ms
LOG:  statement: SELECT author_name
	FROM author_year_1988_2017
	GROUP BY author_name
	HAVING
	    MAX(year)=2017 AND
	    MIN(year)=1988 AND
	    count(year)=30;
LOG:  duration: 64.950 ms
LOG:  statement: DROP TABLE h_family;
LOG:  duration: 4.519 ms
LOG:  statement: DROP TABLE author_year_1988_2017;
LOG:  duration: 1.293 ms
LOG:  statement: SELECT author_name
	INTO early_author
	FROM publication_author pa
	WHERE pa.pub_date IN (
	    SELECT MIN(pub_date)
	    FROM publication_author
	)
	GROUP BY author_name;
LOG:  duration: 24971.461 ms
LOG:  statement: SELECT ea.author_id, ea.author_name, count(*) as pub_count
	FROM authored ad, (
	    SELECT a.*
	    FROM author a, early_author ea
	    WHERE a.author_name = ea.author_name
	) as ea
	WHERE ad.author_id = ea.author_id
	GROUP BY ea.author_id, ea.author_name;
LOG:  duration: 1317.111 ms
LOG:  statement: DROP TABLE IF EXISTS early_author;
LOG:  duration: 1.832 ms
LOG:  statement: DROP VIEW IF EXISTS yearly_author_pub_count CASCADE;
LOG:  duration: 0.099 ms
LOG:  statement: CREATE VIEW yearly_author_pub_count AS (
	    SELECT extract(year from pub_date) as year, author_name, COUNT(*) AS pub_count
	    FROM publication_author
	    GROUP BY year, author_name
	    ORDER BY year, COUNT(*) DESC
	);
LOG:  duration: 0.912 ms
LOG:  statement: WITH result AS (
	    SELECT *, ROW_NUMBER() OVER (PARTITION BY year ORDER BY pub_count DESC) AS row
	    FROM yearly_author_pub_count
	)
	SELECT year, author_name, pub_count
	FROM result
	WHERE row = 1;
LOG:  duration: 18139.933 ms
LOG:  received smart shutdown request
LOG:  autovacuum launcher shutting down
LOG:  shutting down
LOG:  database system is shut down
